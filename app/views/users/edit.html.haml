- title "Redigera profil för #{@user.displayname}"
%section.box.form#edit-user
  %h1.box-title= h1
  .box-content
    = simple_form_for @user, html: { class: "form-horizontal" } do |f|
      = f.error_notification class: "warning"

      - if @user.roles.empty? # When user is directed here to select roles
        %p.warning= "Välj en eller flera förvaltningar/arbetsfält nedan."

      .control-group.readonly
        .control-label Namn:
        .controls
          = "#{@user.first_name} #{@user.last_name}"
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p= "Ditt namn hämtas från HR-systemet. Ditt namn kan du ändra genom att kontakta din egen förvaltnings lokala HR-funktion. Det vanligaste är att du vill ändra för att ditt namn är felstavat eller för att du byter efternamn."
            %p= "Kontaktuppgift till din lokala HR-finktion hittar du på Komin > Min förvaltning > Vår organisation."

      .control-group.readonly
        .control-label HR-titel:
        .controls
          = @user.title
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p= "Din HR-titel hämtas från HR-systemet och kontaktboken visar den titel som är kopplad till din primära anställning. Din HR-titel är den titel du fick med när du anställdes i Malmö stad. Ändring av HR-titeln kan endast göras när du byter tjänst."
            %p= "Om du upplever att du är anställd med fel titel, diskutera med din linjechef."

      = f.input :professional_bio, input_html: { class: 'input-wide', rows: 7 }

      .control-group.readonly
        .control-label Förvaltning:
        .controls
          = @user.company_short
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p= "Din förvaltning hämtas från HR-systemet och kontaktboken visar den förvaltningstillhörighet som är kopplad till din primära anställning."
            %p= "Om du upplever att kontaktboken visar en annan förvaltning än den du är anställd i, kontakta kominteamet@malmo.se."

      .control-group.readonly
        .control-label Avdelning:
        .controls
          = @user.department
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p= "Avdelningstillhörighet är under utveckling och kommer efter sommaren."

      = f.input :status_message, input_html: { class: 'input-wide' }

      %h2.form-group-title Grundprofil i Komin:
      = f.association :roles, as: :check_boxes, collection: @roles.select { |r| r.category == "department" }, label: "Förvaltningar:"
      = f.association :roles, as: :check_boxes, collection: @roles.select { |r| r.category == "working_field" }, label: "Arbetsfält:",
          hint: "Här väljer du vilken/vilka förvaltningar/arbetsfält du vill se i Kominflikarna Min förvaltning, Mitt arbetsfält högst upp i Komin."

      %h2.form-group-title Kontakt
      .control-group.readonly
        .control-label E-post:
        .controls
          = @user.email
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p= "Din e-postadress finns lagrad i Malmö stads centrala databas över alla anställda. Kontaktboken visar vilken e-postadress som är knuten till dig. Om det visas fel e-postadress, kontakta ITS, 040-342727."

      .control-group.readonly
        .control-label Fast telefon:
        .controls
          = @user.phone
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p
              = "Ditt fasta telefonnummer finns lagrat i Malmö stads centrala databas över alla anställda. Kontaktboken visar vilket nummer som är knutet till dig. Om det visas fel telefonnummer beställer du en ändring i "
              = link_to "IT-kompassen.", "http://marval.malmo.se/MSMSelfService/Itservice/telefoni-forandring.aspx"
              = "Om du behöver hjälp, kontakta ITS, 040-342727."

      .control-group.readonly
        .control-label Mobiltelefon:
        .controls
          = @user.cell_phone
          = link_to "(Info)", "#", class: "show-change-info"
          .change-info
            %p
              = "Ditt mobilnummer finns lagrat i Malmö stads centrala databas över alla anställda. Kontaktboken visar vilket nummer som är knutet till dig. Om det visas fel telefonnummer beställer du en ändring i "
              = link_to "IT-kompassen.", "http://marval.malmo.se/MSMSelfService/Itservice/telefoni-forandring.aspx"
              = "Om du behöver hjälp, kontakta ITS, 040-342727."

      = f.input :skype

      %h2.form-group-title Arbetsplats
      = f.input :room
      = f.input :address, input_html: { class: 'input-wide' }
      = f.hidden_field :geo_position_x
      = f.hidden_field :geo_position_y
      = f.hidden_field :post_code
      = f.hidden_field :postal_town
      = f.hidden_field :neighborhood

      %h2.form-group-title Kompetensprofil
      = f.input :skill_list,
        input_html: { "data-path" => skills_suggest_path, "data-load" => @user.skills.map{ |l| { id: l.name, name: l.name }}.to_json, class: "input-wide" }

      = f.input :language_list,
        input_html: { "data-path" => languages_suggest_path, "data-load" => @user.languages.map{ |l| { id: l.name, name: l.name }}.to_json, class: "input-wide" }

      %h2.form-group-title Personsligt
      = f.input :private_bio, input_html: { class: 'input-wide', rows: 7 }

      = f.input :twitter, wrapper: :prepend do
        %span.add-on @
        = f.input_field :twitter

      = f.input :homepage, input_html: { class: 'input-wide' }

      - if admin?
        %h2.form-group-title Rättigheter
        = f.input :admin
        = f.input :early_adopter

      .control-group
        .controls
          = f.button :submit, :class => 'btn-primary'
          = link_to t('actions.cancel'), user_path(@user.username), class: "btn"
